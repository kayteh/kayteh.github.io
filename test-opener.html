<!doctype html>
<meta charset="utf-8">
<pre id="container"></pre>

<script>

function unable() {
  document.getElementById('container').innerHTML = "failed."
}

function addOut(text) {
  document.getElementById('container').innerHTML = document.getElementById('container').innerHTML + text + "\n"
}

function dispatchShim() {
  addOut("dispatched: ", arguments)
}

function reducerShim(type, action) {
  addOut("reducer: ", type)
}

function able() {
  if (window.opener) {
    opener.state = { dispatch: dispatchShim, getState: function(){return{}}, reducer: reducerShim }
  } else {
    unable()
  }
}


if (window.opener === null) {
  unable()
} else {
  able()
}
</script>
